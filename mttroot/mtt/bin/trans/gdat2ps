#! /bin/sh

     ###################################### 
     ##### Model Transformation Tools #####
     ######################################

# Bourne shell script: dat2ps

# Converts a data file to a ps file

# Copyright (c) P.J.Gawthrop, 1996.

###############################################################
## Version control history
###############################################################
## $Id$
## $Log$
## Revision 1.2  1996/08/10 12:54:56  peter
## Reorganised data file for gnuplot input.
##
## Revision 1.1  1996/08/10 09:52:39  peter
## Initial revision
##
###############################################################

echo Creating $1.ps

# Convert multi-columns into gnuplot format -
# ie stack two columns vertically separated by blank lines
awk '
BEGIN{row=0; col=0}
{ 
  row++;
  for (col = 1; col <= NF/2; col++) {
    xcol = 2*col-1;
    ycol = 2*col;
    x[row,col] = $xcol
    y[row,col] = $ycol
  }
}
END {
  cols = col-1;
  rows = row;
  for (col = 1; col <= cols; col++) {
    for (row = 1; row <= rows; row++) {
      print x[row,col], y[row,col]
    };
  if (col<cols) {
    printf("\n")
  }
  }
}' $1.dat > $1.gdat

gnuplot << EOF
  set terminal postscript
  set output '$1.ps'
  set grid
  set title "$1.dat. Generated by MTT on $(date)"
  plot '$1.gdat' with lines
  exit
EOF
