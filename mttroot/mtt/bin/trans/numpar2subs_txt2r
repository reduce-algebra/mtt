#! /bin/sh

  ###################################### 
  ##### Model Transformation Tools #####
  ######################################
  
## Makes algebraic substitution file from numpar file.
## Omitting all parameter in 2nd argument

  ###############################################################
  ## Version control history
  ###############################################################
  ## $Id$
  ## $Log$
  ###############################################################

# Copyright (C) 2002 by Peter J. Gawthrop

sys=$1
pars=$2

outfile=${sys}_subs.r
infile=${sys}_numpar.txt

echo Creating ${outfile} from ${infile}
cat<<EOF > ${outfile}_1
%% File ${outfile} generated on `date` from  ${infile}
%% All parameters replaced by numbers except for:
%%   ${pars}

EOF

sed 's/#/%/g' < Compensator_numpar.txt | sed 's/=/:=/' >> ${outfile}_1

cat >> ${outfile}_1 <<EOF
ON ROUNDED; %% Floating point
END;
EOF

gawk '
{
N=split(pars,par);
matched=0;
for (i=1;i<=N;i++)
  if ($1==par[i]) 
    matched=1;

if (!matched) print $0
}' pars="$pars" < ${outfile}_1 > ${outfile}

rm ${outfile}_1

